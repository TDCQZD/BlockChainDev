
# record

## 以太坊合约

```
truffle(development)> amt_1 = web3.toWei(1,'ether');
'1000000000000000000'
truffle(development)>
```

```
truffle(development)> current_time = Math.round(new Date() / 1000);
1541729106
truffle(development)>
```
```
truffle(development)> EcommerceStore.deployed().then(function(i) {i.addProductToStore('iphone 6', 'Cell Phones & Accessories', 'imagelink', 'desclink', current_time, current_time + 200, amt_1, 0).then(function(f) {console.log(f)})});
undefined
truffle(development)> { tx: '0x528f32f71b156656c074bcdcd8687cc45930588fd94d57391526ee1c54de2df1',
  receipt: 
   { transactionHash: '0x528f32f71b156656c074bcdcd8687cc45930588fd94d57391526ee1c54de2df1',
     transactionIndex: 0,
     blockHash: '0x5908bbfac1c45463fc6672ebd66c620ff67d2c29513dfdcfe1720609e89e68d1',
     blockNumber: 5,
     gasUsed: 264627,
     cumulativeGasUsed: 264627,
     contractAddress: null,
     logs: [],
     status: '0x1',
     logsBloom: '0x00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000' },
  logs: [] }

undefined
truffle(development)>
```

```
truffle(development)> EcommerceStore.deployed().then(function(i) {i.getProduct.call(1).then(function(f) {console.log(f)})});
undefined
truffle(development)> [ BigNumber { s: 1, e: 0, c: [ 1 ] },
  'iphone 6',
  'Cell Phones & Accessories',
  'imagelink',
  'desclink',
  BigNumber { s: 1, e: 9, c: [ 1541729106 ] },
  BigNumber { s: 1, e: 9, c: [ 1541729306 ] },
  BigNumber { s: 1, e: 18, c: [ 10000 ] },
  BigNumber { s: 1, e: 0, c: [ 0 ] },
  BigNumber { s: 1, e: 0, c: [ 0 ] } ]
truffle(development)> 

```

```
truffle(development)> web3.fromWei(web3.eth.getBalance(web3.eth.accounts[0]).toString(),'ether')
'99.8147352'
truffle(development)> web3.fromWei(web3.eth.getBalance(web3.eth.accounts[1]).toString(),'ether')
'100'
truffle(development)> web3.fromWei(web3.eth.getBalance(web3.eth.accounts[2]).toString(),'ether')
'100'



truffle(development)> sealedBid = web3.sha3((2 * amt_1)+'secret1')
'0x00bb488d8eab1d81961b20dac410f48fec67a50800297208d464c394f82dc6a7'

truffle(development)> EcommerceStore.deployed().then(function(i) {i.bid(1, sealedBid, {value: 3*amt_1, from: web3.eth.accounts[1]}).then(function(f) {console.log(f)})});
undefined
truffle(development)> { tx: '0x8b39d3a9144b66f6aa5b53227b4d8a750e7278959f939c1344f4ea2747773be3',
  receipt: 
   { transactionHash: '0x8b39d3a9144b66f6aa5b53227b4d8a750e7278959f939c1344f4ea2747773be3',
     transactionIndex: 0,
     blockHash: '0x31f23e2f9133aec828141a6c2c4b78cf6a3b5227a8a35327bd7a96d9b0ae92fe',
     blockNumber: 6,
     gasUsed: 111689,
     cumulativeGasUsed: 111689,
     contractAddress: null,
     logs: [],
     status: '0x1',
     logsBloom: '0x00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000' },
  logs: [] }

undefined
truffle(development)> sealedBid = web3.sha3((3 * amt_1)+'secret2')
'0x6a7eaf97c63037b8630987869f20c3f3927b7768ec695156322898c6005bfe9e'
truffle(development)> EcommerceStore.deployed().then(function(i) {i.bid(1, sealedBid, {value: 3*amt_1, from: web3.eth.accounts[2]}).then(function(f) {console.log(f)})});
undefined
truffle(development)> { tx: '0x13a8714c32ad11dab8d264ad1523b54954328587ba56025c5b34be24f1d421aa',
  receipt: 
   { transactionHash: '0x13a8714c32ad11dab8d264ad1523b54954328587ba56025c5b34be24f1d421aa',
     transactionIndex: 0,
     blockHash: '0xe6a51adc4752ec6f0d9e2d0e33c1fa69a145ddbb1ae45a9d493832e9af9c662c',
     blockNumber: 7,
     gasUsed: 96753,
     cumulativeGasUsed: 96753,
     contractAddress: null,
     logs: [],
     status: '0x1',
     logsBloom: '0x00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000' },
  logs: [] }

undefined

truffle(development)> web3.fromWei(web3.eth.getBalance(web3.eth.accounts[1]).toString(),'ether')
'96.9888311'
truffle(development)> web3.fromWei(web3.eth.getBalance(web3.eth.accounts[2]).toString(),'ether')
'96.9903247'



```
```
truffle(development)> EcommerceStore.deployed().then(function(i){i.revealBid(1,(2*amt_1).toString(),'secret1',{from: web3.eth.accounts[1]}).then(function(res){console.log(res)})})
undefined
truffle(development)> { tx: '0xcf50c163e707b0e50b748c0b1c18b8b0136125fd8b44604fda29090f5300e603',
  receipt: 
   { transactionHash: '0xcf50c163e707b0e50b748c0b1c18b8b0136125fd8b44604fda29090f5300e603',
     transactionIndex: 0,
     blockHash: '0x1a0bfd1b5c53199790dbc04611e31d24b9f89981596ec47d1684a6266e4b25b1',
     blockNumber: 8,
     gasUsed: 124160,
     cumulativeGasUsed: 124160,
     contractAddress: null,
     logs: [],
     status: '0x1',
     logsBloom: '0x00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000' },
  logs: [] }

undefined

```

```
truffle(development)> EcommerceStore.deployed().then(function(i) {i.highestBidderInfo.call(1).then(function(res) {console.log(res)})})
undefined
truffle(development)> [ '0x11d0672ae81db9876c8ea8b00a034925cf95038e',
  BigNumber { s: 1, e: 18, c: [ 20000 ] },
  BigNumber { s: 1, e: 18, c: [ 10000 ] } ]

undefined
truffle(development)> EcommerceStore.deployed().then(function(i) {i.totalBids.call(1).then(function(res) {console.log(res)})})
undefined
truffle(development)> BigNumber { s: 1, e: 0, c: [ 2 ] }

undefined
truffle(development)> web3.fromWei(web3.eth.getBalance(web3.eth.accounts[1]).toString(),'ether')
'97.9764107'
truffle(development)> web3.fromWei(web3.eth.getBalance(web3.eth.accounts[2]).toString(),'ether')
'96.982043'
truffle(development)> 

```


```
truffle(development)> EcommerceStore.deployed().then(function(i){i.revealBid(1,(2*amt_1).toString(),'secret2',{from: web3.eth.accounts[1]}).then(function(res){console.log(res)}).catch(console.log)})
undefined
truffle(development)> Error: VM Exception while processing transaction: revert bidder should exist
```

## web 产品

```
root@Aws:~/ethereum/dapp/ebay_dapp# truffle compile
root@Aws:~/ethereum/dapp/ebay_dapp# truffle migrate
Using network 'development'.

Running migration: 1_initial_migration.js
  Deploying Migrations...
  ... 0x9090e7abd3c43ae1656c3ce26da8accf16442265f8cda11bbe71468686edd80d
  Migrations: 0x9dbc8356f96fca98dc8fd80130be241459f8b957
Saving successful migration to network...
  ... 0xacd5078ffb2127c4e90f87798ce387e0ee56e71944f18c33fba43459e58c0801
Saving artifacts...
Running migration: 2_deploy_contracts.js
  Deploying EcommerceStore...
  ... 0x3f639a83a1eb9d1d1357d538f24dda99f88a727fc0669779bca27f6162237c77
  EcommerceStore: 0x7b2ad32d8f9e44c0673d979f1e46421e96e8b31c
Saving successful migration to network...
  ... 0x3ab55702b3e6c17ef25b37796936e19945dd09e43485c72112c2c82cfa08cc1e
Saving artifacts...
root@Aws:~/ethereum/dapp/ebay_dapp# truffle exec seed.js 
Using network 'development'.

BigNumber { s: 1, e: 0, c: [ 6 ] }
{ tx: '0x4414193fac1d592220f3f4697616a429a7d815acdf7b4b2e232df0c510111dc1',
  receipt: 
   { transactionHash: '0x4414193fac1d592220f3f4697616a429a7d815acdf7b4b2e232df0c510111dc1',
     transactionIndex: 0,
     blockHash: '0x591285ccc0e08986fd9abe0ec1362b12369e9eb3c30a2beb9012f16627fe872d',
     blockNumber: 5,
     gasUsed: 350063,
     cumulativeGasUsed: 350063,
     contractAddress: null,
     logs: [],
     status: '0x1',
     logsBloom: '0x00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000' },
  logs: [] }
{ tx: '0x7db9b1adc2eb2e594f211869f5a994a5abed2201642bd67a95c8aa51895941c9',
  receipt: 
   { transactionHash: '0x7db9b1adc2eb2e594f211869f5a994a5abed2201642bd67a95c8aa51895941c9',
     transactionIndex: 0,
     blockHash: '0x0502037e1c19959a2c52b386afa8ffa4a64cef12d9c13f9c1f0a824d28652e08',
     blockNumber: 6,
     gasUsed: 350191,
     cumulativeGasUsed: 350191,
     contractAddress: null,
     logs: [],
     status: '0x1',
     logsBloom: '0x00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000' },
  logs: [] }
{ tx: '0x0d4106d0f4ac9354732e2f9e8bf21c07ac8b41570d20685e1eb7367817643452',
  receipt: 
   { transactionHash: '0x0d4106d0f4ac9354732e2f9e8bf21c07ac8b41570d20685e1eb7367817643452',
     transactionIndex: 0,
     blockHash: '0x5b5740a061e8c52c81b31cd088afa854319d5541a80c891b308d38bb11a3c278',
     blockNumber: 7,
     gasUsed: 335063,
     cumulativeGasUsed: 335063,
     contractAddress: null,
     logs: [],
     status: '0x1',
     logsBloom: '0x00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000' },
  logs: [] }
{ tx: '0x5139956ae987eef000ace8b9e60dc79e672999d69db45bf743afb062c513b21a',
  receipt: 
   { transactionHash: '0x5139956ae987eef000ace8b9e60dc79e672999d69db45bf743afb062c513b21a',
     transactionIndex: 0,
     blockHash: '0x6296f7179967787ef9edb79601a836ff5237bbe4352adaf6e8cae13bc1665221',
     blockNumber: 8,
     gasUsed: 350191,
     cumulativeGasUsed: 350191,
     contractAddress: null,
     logs: [],
     status: '0x1',
     logsBloom: '0x00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000' },
  logs: [] }
{ tx: '0xc43eb00433ede503d02d03c17c412cbb07f21fa18de677e194925b8131dd5ab6',
  receipt: 
   { transactionHash: '0xc43eb00433ede503d02d03c17c412cbb07f21fa18de677e194925b8131dd5ab6',
     transactionIndex: 0,
     blockHash: '0x2aeee2d2882d6856216c7eff6620ea9d717a0940595d316b0402ed12540b1779',
     blockNumber: 9,
     gasUsed: 350127,
     cumulativeGasUsed: 350127,
     contractAddress: null,
     logs: [],
     status: '0x1',
     logsBloom: '0x00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000' },
  logs: [] }
{ tx: '0x05d948581d9be9ab9f3d11f6f4863b167647aba01c24528b1298bf88a7fa76c5',
  receipt: 
   { transactionHash: '0x05d948581d9be9ab9f3d11f6f4863b167647aba01c24528b1298bf88a7fa76c5',
     transactionIndex: 0,
     blockHash: '0x46779103f5c244dccb0721dda3e2c1d644484a1dcf25d7e143290c2b307c7619',
     blockNumber: 10,
     gasUsed: 350191,
     cumulativeGasUsed: 350191,
     contractAddress: null,
     logs: [],
     status: '0x1',
     logsBloom: '0x00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000' },
  logs: [] }
root@Aws:~/ethereum/dapp/ebay_dapp# truffle compile
root@Aws:~/ethereum/dapp/ebay_dapp# truffle migrate
Could not connect to your Ethereum client. Please check that your Ethereum client:
    - is running
    - is accepting RPC connections (i.e., "--rpc" option is used in geth)
    - is accessible over the network
    - is properly configured in your Truffle configuration file (truffle.js)

root@Aws:~/ethereum/dapp/ebay_dapp# truffle compile
root@Aws:~/ethereum/dapp/ebay_dapp# truffle migrate
Using network 'development'.

Running migration: 1_initial_migration.js
  Deploying Migrations...
  ... 0x9090e7abd3c43ae1656c3ce26da8accf16442265f8cda11bbe71468686edd80d
  Migrations: 0x1e8b7f5b3348dda24688189c891e84072e6e3caa
Saving successful migration to network...
  ... 0xae3e4e0a2ecbf3d82fbef937c32612ebb7255931855be9fb634cbb6360138659
Saving artifacts...
Running migration: 2_deploy_contracts.js
  Deploying EcommerceStore...
  ... 0x3f639a83a1eb9d1d1357d538f24dda99f88a727fc0669779bca27f6162237c77
  EcommerceStore: 0xb64f2eb26b606c07a574d8b8dc850d8324826b45
Saving successful migration to network...
  ... 0xc23cf96c4e6e227e1b5dc6e5cc71552232a1a78c87b127440c09d9d79f92dc85
Saving artifacts...
root@Aws:~/ethereum/dapp/ebay_dapp# truffle exec seed.js 
Using network 'development'.

BigNumber { s: 1, e: 0, c: [ 6 ] }
{ tx: '0x32b46a4d71b086a51953234b5032d888756da43da537db9926b43029fe72bb2e',
  receipt: 
   { transactionHash: '0x32b46a4d71b086a51953234b5032d888756da43da537db9926b43029fe72bb2e',
     transactionIndex: 0,
     blockHash: '0x0a99d7887be8c009df8a34ec3f45e8bc1ebea0129ef196278587d1728660a7e5',
     blockNumber: 5,
     gasUsed: 350063,
     cumulativeGasUsed: 350063,
     contractAddress: null,
     logs: [],
     status: '0x1',
     logsBloom: '0x00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000' },
  logs: [] }
{ tx: '0x7ec30f502b14ceebf315fffc05fc1f3ef03f12d2ae5a32a5d35487bddba9c3b4',
  receipt: 
   { transactionHash: '0x7ec30f502b14ceebf315fffc05fc1f3ef03f12d2ae5a32a5d35487bddba9c3b4',
     transactionIndex: 0,
     blockHash: '0x981f3259ef6eb222450d351a363a9e05b540e3055102851a95c21cc2faf9eb12',
     blockNumber: 6,
     gasUsed: 350191,
     cumulativeGasUsed: 350191,
     contractAddress: null,
     logs: [],
     status: '0x1',
     logsBloom: '0x00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000' },
  logs: [] }
{ tx: '0xe5581eaf63b3ea5924e165cb60698579352551338cab5d237f82ca1980daab4c',
  receipt: 
   { transactionHash: '0xe5581eaf63b3ea5924e165cb60698579352551338cab5d237f82ca1980daab4c',
     transactionIndex: 0,
     blockHash: '0x5e7eaf2f006cebaf1a4f2666ce5c0df8752195293894b39a0ade0eca6d5bfafb',
     blockNumber: 7,
     gasUsed: 335063,
     cumulativeGasUsed: 335063,
     contractAddress: null,
     logs: [],
     status: '0x1',
     logsBloom: '0x00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000' },
  logs: [] }
{ tx: '0x09a93fedf99a781273231c59486530941956d03935b1a2221fd5f01f859da418',
  receipt: 
   { transactionHash: '0x09a93fedf99a781273231c59486530941956d03935b1a2221fd5f01f859da418',
     transactionIndex: 0,
     blockHash: '0xeed3d12aee5b814bc3e48676b346644958622623fc3968ce2b457e46310efbc4',
     blockNumber: 8,
     gasUsed: 350191,
     cumulativeGasUsed: 350191,
     contractAddress: null,
     logs: [],
     status: '0x1',
     logsBloom: '0x00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000' },
  logs: [] }
{ tx: '0xbe88c71b682a64f7794390e027c8757779751ab93e9c79b2eac6aa1fc804b07b',
  receipt: 
   { transactionHash: '0xbe88c71b682a64f7794390e027c8757779751ab93e9c79b2eac6aa1fc804b07b',
     transactionIndex: 0,
     blockHash: '0xb2620ea00fb4229cb8dd786451ce66a716a7ca844c6f954cd83a67680bc5392f',
     blockNumber: 9,
     gasUsed: 350127,
     cumulativeGasUsed: 350127,
     contractAddress: null,
     logs: [],
     status: '0x1',
     logsBloom: '0x00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000' },
  logs: [] }
{ tx: '0x6ff55323b0251bf1b19beb24263a3c0b9dd216b786ad3eee2cba889b748035b4',
  receipt: 
   { transactionHash: '0x6ff55323b0251bf1b19beb24263a3c0b9dd216b786ad3eee2cba889b748035b4',
     transactionIndex: 0,
     blockHash: '0xbfd653355eff851043c3202690fe695fac6473eab165ace808e156122d12efdd',
     blockNumber: 10,
     gasUsed: 350191,
     cumulativeGasUsed: 350191,
     contractAddress: null,
     logs: [],
     status: '0x1',
     logsBloom: '0x00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000' },
  logs: [] }
root@Aws:~/ethereum/dapp/ebay_dapp# 
```