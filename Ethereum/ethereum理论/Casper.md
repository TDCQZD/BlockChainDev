# Casper -太坊权益证明协议

## 什么是工作量证明（Proof of Work）？
大多数加密货币包括比特币都使用“工作量证明”。工作量证明的过程具有下列步骤：

- 矿工们解答密码学谜题以“挖出”一个区块并加入到区块链上。
- 这一个过程要求大量的电力和运算。在系统中，这些谜题已经被设计成艰难而又繁重。
- 当一个矿工解决一个谜题的时候，他们发布他们的区块到网络上接受验证。
- 验证一个区块是否属于一条链是一个非常简单的过程。
工作量证明系统，在本质上说就是这样的。解决谜题是困难的，但检查答案是否正确则是容易的。它也是比特币（Bitcoin）和Ethereum（直到现在）一直在用的系统。但是，这套系统存在一些根本的缺陷。
### 工作量证明的问题
事实证明，工作量证明存在非常多的问题。

- 首先，也是最重要的，工作量证明是个极端低效的系统，因为它消耗大量的电力和能量。
- 可以购买更快更强劲的ASIC设备的人们和机构通常可以比其他人拥有更高的概率挖到区块。
- 上一点导致的结果是，比特币并没有像它希望的那样分散化。

## 什么是权益证明？
权益证明将让整个挖矿过程虚拟化，并以验证者取代矿工。

以下是权益证明的运行过程：

- 验证者必须锁定一些他们拥有的币作为保证金。
- 在此之后，他们将开始验证区块。同时，当他们发现一个他们认为可以被加到链上的区块时，他们会通过下赌注来验证它。
- 如果该区块成功上链，验证者就将得到一个与他们的赌注成比例的奖励。

### 权益证明最大的障碍

![](http://upyun-assets.ethfans.org/uploads/photo/image/4d0b55ec60ee494eab5ce2d2c7d3df7c.png)

假设我们处在上面的这种情况下，有一条蓝色的主链和一条红色的从主链中分出来的链条，如何禁止一个恶意的矿工在红色区块上挖矿然后推动一次硬分叉（Hard Fork）呢？

**在一个工作量证明系统上，这一风险是可以被减轻的。**

假设恶意矿工Alice想在红色链上挖矿。即便她投入了她所有的哈希算力，也不会有任何矿工加入她在新链上挖矿。每个其他人都将继续在蓝色链上挖矿，因为在最长的链上挖矿收益更可观，而且没有风险。

**记住，工作量证明在资源方面是非常昂贵的。对一个矿工来说，花费许多资源在一个将会被网络拒绝的区块上是没有任何意义的。因此，链分裂在一个工作量证明系统中是被避免了的，因为攻击者将不得不付出大量金钱。**

但是，当你把这种情形放到到权益证明下的时候，事情看起来就有些不一样了。如果你是一个验证者，你可以简单地把钱投到红蓝两条链上，完全无需担心间接的不良后果。不管发生什么事，你都总是可以赢，不会失去任何东西，不管你的行为有多恶意。

这就是所谓的“无利害关系（Nothing at Stake）”问题，也是以太坊必须解决的问题。他们需要一种协议，可以实行权益证明，同时减少“无利害关系”问题。
## 以太坊Casper
Csaper是以太坊选择实行的PoS协议.

Casper实施了一个进程，使得它可以惩罚所有的恶意因素。这就是权益证明在Casper下是如何工作的：

- 验证者押下一定比例的他们拥有的以太币作为保证金。
- 然后，他们将开始验证区块。也就是说，当他们发现一个可以他们认为可以被加到链上的区块的时候，他们将以通过押下赌注来验证它。
- 如果该区块被加到链上，然后验证者们将得到一个跟他们的赌注成比例的奖励。
- 但是，如果一个验证者采用一种恶意的方式行动、试图做“无利害关系”的事，他们将立即遭到惩罚，他们所有的权益都会被砍掉。

正如你可以看到的，Casper被设计成可以在一个无需信任的系统上工作，并且是更加拜占庭容错的。

任何人，如果以一种恶意的，或者说是拜占庭叛徒式的方式行动，就会立即受到惩罚、失去他们的保证金。这就是它不同于其他权益证明协议的地方。恶意元素会失去一些东西，所以，“无利害关系”是不可能的。

这不是唯一一个Casper可以惩罚验证者的地方。

> 正如Hudson James以及Joris Bontje在“StackExchange”的回答中标注的那样，Casper设计了苛刻的激励来保证网络的安全，包括惩罚离线的矿工，不管ta是有意还是无意的。

这意味着验证者将不得不变得对他们的节点正常运行时间小心翼翼。粗心或者懒惰都将导致他们失去自己保证金。这一属性减少了对交易和整体利用率的审查。围绕着所有这些，这种“惩罚”属性同样给予了Casper相对标准工作量证明协议的明显优势。

## Casper FFG
Casper FFG也就是众所周知的Vitalik版Casper，是一个混合PoW/PoS共识机制。它是正准备进行初步应用的版本，也是被精心设计好来缓冲权益证明的转变过程的。设计的方式是，一个权益证明协议被叠加在正常的以太坊版工作量证明协议上。虽然区块仍将通过工作量证明来挖出，每50个区块就将有一个权益证明检查点，也就是网络中验证者评估确定性（Finality）的地方。
## 为什么我们需要Casper？
- 帮助实现分散化
- 高能效
- 经济安全
- 扩展性
- 转移到PoS
## 参考资料
* https://ethfans.org/posts/ethereum-casper